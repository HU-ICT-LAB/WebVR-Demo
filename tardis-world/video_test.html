<!DOCTYPE html>
<html>
    <head>
        <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-aabb-collider-component@3.1.0/dist/aframe-aabb-collider-component.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/ovenplayer/dist/ovenplayer.js"></script>
        <script src="../scripts/dash.js"></script>
        <script src="../scripts/hls.js"></script>
        <script src="../scripts/browserMqtt.js" type="text/javascript"></script>
        <script src="../scripts/mqtt_client.js" type="text/javascript"></script>
        <script src="scripts/movement.js" type="text/javascript"></script>
        <script src="scripts/infinite_objects.js" type="text/javascript"></script>
        <script src="../scripts/push_button.js" type="text/javascript"></script>
        <script src="scripts/robot_controller.js" type="text/javascript"></script>
        <script>
            AFRAME.registerComponent('webrct_stream', {
                init: function(){
                    // Initialize OvenPlayer
                    const player = OvenPlayer.create('player_id', {
                        sources: [
                            {
                                label: 'label_for_webrtc',
                                // Set the type to 'webrtc'
                                type: 'webrtc',
                                // Set the file to WebRTC Signaling URL with OvenMediaEngine 
                                file: 'wss://145.89.163.179:3333/app/stream'
                            }
                        ]
                    });
                    player.play()
                    
                    setTimeout(function(){
                        const videoElement = document.getElementsByClassName("op-media-element-container")[0].children[0]
                        var play_thing = document.querySelector("#video_player")
                        videoElement.setAttribute("id", "MyVideoId")
                        console.log(videoElement)
                        videoElement.setAttribute("id", "MyVideoId")
                        play_thing.setAttribute("src", "#MyVideoId")
                    }, 1000);
                }
            })
        </script>
    </head>   
    <body>

        <a-scene cursor="rayOrigin:mouse">
            <a-assets>
                <a-asset-item id="house" src="assets\models\WoodHouse.glb"></a-asset-item>
                <a-asset-item id="tree" src="assets\models\dark_tree1.glb"></a-asset-item>
                <div id="player_id"></div>
            </a-assets>

            <a-video id="video_player" src="" width="16" height="9" position="0 4.5 -20" webrct_stream></a-video>

            <a-entity id="rig" headbob-movement relative-movement>
                    <a-entity id="camera"  wasd-controls camera look-controls>
                        <a-sky color="#111"></a-sky>
                    </a-entity>
                    <a-entity class="hand" id="leftcontrl" oculus-touch-controls="hand: left" thumbstick-logging ></a-entity>
                    <a-entity class="hand" id="rightcontrl" oculus-touch-controls="hand: right" thumbstick-logging></a-entity>
            </a-entity>

            
        </a-scene>

        <script>

            // Initialize OvenPlayer
            
            
        </script>
    </body>
</html>

