<html>

<head>
    <script src="perlin.js"></script>
</head>

<body>
    <canvas id="mainCanvas" width="500" height="500" style="border:1px solid #d3d3d3;"></canvas>
    <script>
        let pv = 1.0
        let kv = 0.5
        let ctx = document.getElementById("mainCanvas").getContext("2d");
        let outArray = [];
        let max = 0;
        let min = 5;
        let wh = 500;
        for (let y = 0; y < wh; y++) {
            let rowArray = [];
            for (let x = 0; x < wh; x++) {
                let n = noise2D(x * 0.01, y * 0.01);
                n += pv;
                n *= kv;
                if (n > max) {
                    max = n;
                }
                if (n < min) {
                    min = n;
                }
                // if ((y > 98 && y < 158) && (x > 98 && x < 158)) {
                //     n = 0
                // }
                rowArray.push(n);
                let rgb = Math.round(255 * n);
                ctx.fillStyle = "rgba(" + rgb + "," + rgb + "," + rgb + ",1.0)";
                ctx.fillRect(x, y, 1, 1);
            }
            outArray.push(rowArray);
        }
        console.log('min: ' + min + ' max: ' + max);

        function blurImage() {
            let = minPixelAroundFlatSpot = 1;
            let y = 98
            for (let x = 98; x < 158; x++) {
                let pixelVal = outArray[y][x];
                if (pixelVal < minPixelAroundFlatSpot) {
                    minPixelAroundFlatSpot = pixelVal
                }
            }

            y = 158
            for (let x = 98; x < 158; x++) {
                let pixelVal = outArray[y][x];
                if (pixelVal < minPixelAroundFlatSpot) {
                    minPixelAroundFlatSpot = pixelVal
                }
            }

            let x = 98
            for (let y = 98; y < 158; y++) {
                let pixelVal = outArray[y][x];
                if (pixelVal < minPixelAroundFlatSpot) {
                    minPixelAroundFlatSpot = pixelVal
                }
            }

            x = 158
            for (let y = 98; y < 158; y++) {
                let pixelVal = outArray[y][x];
                if (pixelVal < minPixelAroundFlatSpot) {
                    minPixelAroundFlatSpot = pixelVal
                }
            }

            console.log(minPixelAroundFlatSpot);

            for (let y = 99; y < 158; y++) {
                for (let x = 99; x < 158; x++) {
                    n = minPixelAroundFlatSpot;
                    outArray[y][x] = n
                    let rgb = Math.round(255 * n);
                    ctx.fillStyle = "rgba(" + rgb + "," + rgb + "," + rgb + ",1.0)";
                    ctx.fillRect(x, y, 1, 1);
                }
            }
        }

    </script>
</body>

</html>